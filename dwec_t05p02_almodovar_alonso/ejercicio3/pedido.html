<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DWEC - Ejercicios T05 - Alonso Almodóvar</title>

    <link rel="stylesheet" href="css/micss.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
</head>

<body class="bg-light d-flex flex-column min-vh-100">

    <header class="bg-white border-bottom">
        <div class="container">
            <div class="d-flex align-items-center py-3">
                <i class="bi bi-book-half fs-2 me-2 text-primary"></i>
                <span class="fs-4 fw-semibold">Librería Almodóvar</span>
            </div>
        </div>
    </header>

    <nav class="bg-primary">
        <div class="container-fluid px-0">
            <ul class="nav nav-pills nav-fill text-center">
                <li class="nav-item">
                    <a class="nav-link rounded-0 py-3 fw-semibold text-white" href="catalogo.html">
                        <i class="bi bi-journal-bookmark me-1"></i> Catálogo
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link rounded-0 py-3 fw-semibold text-white" href="cliente.html">
                        <i class="bi bi-people me-1"></i> Cliente
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link rounded-0 py-3 fw-semibold text-white" href="libro.html">
                        <i class="bi bi-book me-1"></i> Libro
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link rounded-0 py-3 fw-semibold text-white" href="pedido.html">
                        <i class="bi bi-cart me-1"></i> Pedido
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="container my-4 flex-grow-1">
        <div class="accordion" id="accordionPedido">
            <!-- ACORDEÓN 1: CLIENTE -->
            <div class="accordion-item" id="itemCliente">
                <h2 class="accordion-header">
                    <button class="accordion-button fw-semibold" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseCliente">
                        <i class="bi bi-person me-2"></i> 1. Selección de Cliente
                    </button>
                </h2>
                <div id="collapseCliente" class="accordion-collapse collapse show" data-bs-parent="#accordionPedido">
                    <div class="accordion-body">
                        <form id="formCliente" class="needs-validation" novalidate>
                            <div class="row g-3 align-items-center">
                                <div class="col-md-6">
                                    <div class="input-group has-validation">
                                        <span class="input-group-text">DNI</span>
                                        <input type="number" id="dni" class="form-control" min="10000000" max="99999999"
                                            placeholder="DNI" required>
                                        <button class="btn btn-primary" type="submit" id="btnBuscarCliente">
                                            <i class="bi bi-search"></i>
                                        </button>
                                        <div class="invalid-feedback">
                                            Introduce un DNI válido existente.
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div id="infoClienteSeleccionado" class="p-2 border rounded bg-light d-none">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <span>Cliente: <strong id="nombreClienteSeleccionado"></strong></span>
                                            <button type="button" class="btn btn-sm btn-outline-danger"
                                                id="btnDeseleccionarCliente">Deseleccionar</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- ACORDEÓN 2: LIBRO -->
            <div class="accordion-item" id="itemLibro">
                <h2 class="accordion-header">
                    <button class="accordion-button fw-semibold collapsed" id="btnAccordeonLibro" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseLibro" disabled>
                        <i class="bi bi-book me-2"></i> 2. Añadir Libros
                    </button>
                </h2>
                <div id="collapseLibro" class="accordion-collapse collapse" data-bs-parent="#accordionPedido">
                    <div class="accordion-body">
                        <form id="formOperacionLibro" class="needs-validation" novalidate>
                            <!-- ISBN -->
                            <div class="row g-3 align-items-center mb-3">
                                <div class="col-md-5">
                                    <div class="input-group has-validation">
                                        <span class="input-group-text">ISBN</span>
                                        <input type="text" id="isbn" class="form-control" placeholder="ISBN" required>
                                        <button class="btn btn-primary" type="button" id="btnBuscarLibro">
                                            <i class="bi bi-search"></i>
                                        </button>
                                        <div class="invalid-feedback" id="feedbackIsbn">
                                            El ISBN es obligatorio y debe estar registrado
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- DETALLES Y UNIDADES -->
                            <div id="anadirLibro" class="row g-3 d-none align-items-end border-top pt-3">
                                <div class="col-md-6">
                                    <div id="infoLibroSeleccionado"
                                        class="p-2 border rounded bg-light h-100 d-flex align-items-center">
                                        <span>Libro: <strong id="tituloLibroSeleccionado"></strong></span>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="inputUnidades" class="form-label small fw-bold">Unidades</label>
                                    <input type="number" id="inputUnidades" class="form-control" value="1" min="1"
                                        required>
                                    <div class="invalid-feedback">Mínimo 1 unidad.</div>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-success w-100" type="submit" id="btnAnadirLibro">
                                        <i class="bi bi-plus-circle"></i> Añadir
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- ACORDEÓN 3: ENVÍO -->
            <div class="accordion-item" id="itemEnvio">
                <h2 class="accordion-header">
                    <button class="accordion-button fw-semibold collapsed" id="btnAccordeonEnvio" type="button"
                        data-bs-toggle="collapse" data-bs-target="#collapseEnvio" disabled>
                        <i class="bi bi-truck me-2"></i> 3. Tipo de Envío
                    </button>
                </h2>
                <div id="collapseEnvio" class="accordion-collapse collapse" data-bs-parent="#accordionPedido">
                    <div class="accordion-body">
                        <form id="formEnvio" class="needs-validation" novalidate>
                            <div class="row g-3 align-items-center">
                                <div class="col-md-8">
                                    <select class="form-select" id="selectTipoEnvio" required>
                                        
                                    </select>
                                    <div class="invalid-feedback">Debe seleccionar un tipo de envío válido.</div>
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-primary w-100" type="submit">Confirmar Envío</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- RESUMEN -->
        <div class="card mt-4 shadow-sm">
            <div class="card-header bg-white fw-bold">Resumen del Pedido</div>
            <div class="card-body" id="contenedorResumen">
                <p id="resumenVacio" class="text-center text-muted py-3">No hay datos en el pedido todavía.</p>
                <p id="datosCliente"></p>
                <div id="tablaResumen" class="d-none">
                    <table class="table align-middle">
                        <thead>
                            <tr>
                                <th>Libro</th>
                                <th>Cantidad</th>
                                <th>Precio</th>
                            </tr>
                        </thead>
                        <tbody id="cuerpoTablaPedido"></tbody>
                    </table>
                </div>
                <p id="datosEnvio"></p>
            </div>
            <div class="card-footer d-flex justify-content-end gap-2 bg-white">
                <button class="btn btn-outline-secondary" id="btnCancelarPedido">Cancelar</button>
                <button class="btn btn-success px-4" id="btnPagarPedido" disabled>Pagar</button>
            </div>
        </div>
    </main>

    <footer class="bg-white border-top">
        <div class="container">
            <div class="d-flex flex-column flex-md-row justify-content-between align-items-center py-3">
                <p class="mb-2 mb-md-0 text-body-secondary">
                    © 2025 Desarrollo en Cliente · Alonso Almodóvar
                </p>
                <i class="bi bi-bootstrap fs-4 text-primary"></i>
            </div>
        </div>
    </footer>

    <script src="js/_libros.js"></script>
    <script src="js/_autores.js"></script>
    <script src="js/_tiposEnvios.js"></script>
    <script src="js/_clientes.js"></script>
    <script src="js/_pedidos.js"></script>
    <script src="js/_libro.js"></script>
    <script src="js/_cliente.js"></script>
    <script src="js/_leer_datos.js"></script>
    <script src="js/_autor.js"></script>
    <script src="js/_pedido.js"></script>
    <script src="js/_tipoEnvio.js"></script>
    <script src="js/_util.js"></script>
    <script src="js/_tienda.js"></script>
    <script src="js/_principal.js"></script>
    <script src="js/pagPedido.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

    <script>
        (() => {
            "use strict";
            const forms = document.querySelectorAll(".needs-validation");
            Array.from(forms).forEach((form) => {
                form.addEventListener(
                    "submit",
                    (event) => {
                        if (!form.checkValidity()) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add("was-validated");
                    },
                    false
                );
            });
        })();
    </script>
</body>

</html>